classes:

  Template:
    description: A collection of fields representing some entity. 
    comments: 
    - Also called a manifest depending on context.
    abstract: true


  PartialTemplate:
    description: A template for collecting a subset of contextual data; not intended to be a standalone template but rather a subdocument. 

#######################################
# AssayDataTemplate / Sequencing             
#######################################

  AssayDataTemplate:
    is_a: Template
    description: >
      A template for describing deposited data artifacts (i.e. files) from an experimental assay.  
      The properties defined here are things that should be collected for all files contributed to NF. 
      Subclasses define additional properties for the type of file (e.g. raw vs processed, imaging vs sequencing).
    slots:
    - Component
    - resourceType # should be constrained to data resource types but we can't do this yet
    - dataType
    - dataSubtype
    - assay # platform added at a later level, see https://github.com/nf-osi/nf-metadata-dictionary/issues/319
    - individualID # specimenID, aliquotID etc. are added at a later level since they don't make sense for some assay types such as behavioral assays
    - comments
  
  #######################################
  # Sequencing Data - Raw            
  #######################################

  SequencingDataTemplate:
    is_a: AssayDataTemplate
    description: A template for data from a sequencing assay.
    slots:
    - parentSpecimenID
    - specimenID 
    - aliquotID 
    - platform
    - runType
    - nucleicAcidSource
    - dissociationMethod
    - libraryPrep
    - libraryPreparationMethod
    - libraryStrand
    - readPair
    - readLength
    - readDepth

  GenomicsAssayTemplate:
    is_a: SequencingDataTemplate
    description: > 
      Generic sequencing data template that is meant to cover other sequencing-type assays that don't have specified named templates. 
    slots:
    annotations:
      requiresComponent: ''
      required: false
  
  RNASeqTemplate:
    is_a: SequencingDataTemplate
    description: Template for describing raw data from (bulk) RNA-sequencing
    slots:
    - targetDepth
    annotations:
      requiresComponent: ''
      required: false

  ScRNASeqTemplate:
    is_a: RNASeqTemplate
    description: Template for describing raw data from single-cell RNA-seq.
    slots:
    - cellID
    - supplementalLink
    annotations:
      requiresComponent: ''
      required: false
  
  EpigeneticsAssayTemplate:
    is_a: SequencingDataTemplate
    description: Template for describing raw data ATAC-seq.
    slots:
    - 
    - 
    annotations:
      requiresComponent: ''
      required: false
  
  PdxGenomicsAssay:
    is_a: AssayDataTemplate
    description: Template for describing PDX assay data.
    slots:
    - transplantationType
    - transplantationRecipientSpecies
    - transplantationRecipientTissue
    - modelSystemName
    - experimentalCondition
    - experimentalTimepoint
    annotations:
      requiresComponent: ''
      required: false

  GenomicsAssayTemplateExtended:
    is_a: SequencingDataTemplate
    description: >
      Genomics assay template but with additional fields for gene perturbation parameters, experimental conditions and time points.
    slots:
    - transplantationType
    - transplantationRecipientSpecies
    - transplantationRecipientTissue
    - experimentalCondition
    - experimentalTimepoint
    - genePerturbed
    - genePerturbationTechnology
    - genePerturbationType
    - comments
    annotations:
      requiresComponent: ''
      required: false
  
  WGSTemplate:
    is_a: SequencingDataTemplate
    description: Template for describing raw data from Whole Genome Sequencing (WGS)
    slots:


    annotations:
      requiresComponent: ''
      required: false
  
  WESTemplate:
    is_a: AssayDataTemplate
    description: Template for describing raw data from Whole Exome Sequencing (WES)
    slots:
    - targetCaptureKitID
    annotations:
      requiresComponent: ''
      required: false


  #######################################
  # Sequencing Data - Processed            
  #######################################
  
  ProcessedSequencingAssay:
    is_a: AssayDataTemplate
    description: Sequencing data that have gone through some processing workflow.
    slots:
    - workflow
    - workflowLink
    - genomicReference
    annotations:
      requiresComponent: ''
      required: false
  
  ProcessedAlignedReadsTemplate:
    is_a: AssayDataTemplate
    description: >
      Template for describing aligned reads output data (i.e. BAM files).
      The QC meta are extracted from samtools stats when available and are aligned with GDC. 
    slots:
    - averageInsertSize
    - averageReadLength
    - averageBaseQuality
    - pairsOnDifferentChr
    - readsDuplicatedPercent
    - readsMappedPercent
    - meanCoverage
    - proportionCoverage10x
    - proportionCoverage30x
    - readDepth
    - totalReads
    annotations:
      requiresComponent: ''
      required: false
  
  ProcessedVariantCallsTemplate:
    is_a: AssayDataTemplate
    description: Template for describing either germline or variant calls output data (i.e. VCF/MAF)
    slots:
    - isFilteredReads
    annotations:
      requiresComponent: ''
      required: false
  
  ProcessedExpressionTemplate:
    is_a: AssayDataTemplate
    description: Template for describing expression output data as counts or counts matrix
    slots:
    - modelSystemName
    - workflow
    - expressionUnit
    - comments
    annotations:
      requiresComponent: ''
      required: false
  
#######################################
# AssayDataTemplate / Proteomics          
#######################################

  ProteomicsAssayTemplate:
    is_a: AssayDataTemplate
    description: > 
      Template for describing data from the most common LC-MS type proteomics assays.
    slots:
    - parentSpecimenID
    - specimenID
    - proteinExtractSource
    annotations:
      requiresComponent: ''
      required: false

#######################################
# AssayDataTemplate / Imaging            
#######################################

  ImagingDataTemplate:
    is_a: AssayDataTemplate
    description: A template for data from an imaging assay.
    slots:
    - parentSpecimenID
    - specimenID # aliquotID only for certain imaging, e.g. not applicable to images such as MRI or photography
    
  ImagingAssayTemplate:
    is_a: ImagingDataTemplate
    description: Generic template for describing data from an imaging type assay (IHC, etc). This is a one-step template.
    slots:
    - Component
    - Filename
    - resourceType
    - progressReportNumber
    - dataType
    - assay
    - platform
    - assayTarget
    - individualID
    - parentSpecimenID
    - comments
    annotations:
      requiresComponent: ''
      required: false
  
  MRIAssayTemplate:
    is_a: ImagingDataTemplate
    description: Generic template for describing data from an MRI assay. This is a one-step template.
    slots:
    - MRISequence
    annotations:
      requiresComponent: ''
      required: false

#######################################
# AssayDataTemplate / Other             
#######################################
  
  PharmacokineticsAssayTemplate:
    is_a: AssayDataTemplate
    description: Generic template for describing data from a pharmacokinetics assay. This is a one-step template.
    slots:
    - experimentalCondition
    - experimentalTimepoint
    - genePerturbed
    - comments
    annotations:
      requiresComponent: ''
      required: false

  FlowCytometryTemplate:
    is_a: AssayDataTemplate
    description: Basic template for flow cytometry assay
    slots:
    - cellType
    annotations:
      requiresComponent: ''
      required: false

  BehavioralAssayTemplate:
    is_a: AssayDataTemplate
    description: > 
      Generic template for describing data from behavioral/cognitive assays such as “adaptive n-back task” (for humans) or “Von Frey test” (for mice). 
      If another modality is used as part of the assay, e.g. fMRI, that data can be linked.
    slots:
    - platform
    - individualID
    - experimentalCondition
    - experimentalTimepoint
    - comments
    annotations:
      requiresComponent: ''
      required: false
  
  LightScatteringAssayTemplate:
    is_a: AssayDataTemplate
    description: Template for dynamic or static light scattering data adapted from ISA-TAB-Nano specs.
    source: https://wiki.nci.nih.gov/display/icr/isa-tab-nano
    slots:
    - specimenID
    - materialType
    - pH
    - concentrationMaterial
    - concentrationMaterialUnit
    - concentrationNaCl
    - concentrationNaClUnit
    annotations:
      requiresComponent: ''
      required: false
  
  PlateBasedReporterAssayTemplate:
    is_a: AssayDataTemplate
    description: Generic template for describing data from a plate-based reporter assay. This is a one-step template.
    slots:
    - assayTarget
    - experimentalCondition
    - experimentalTimepoint
    - reporterGene
    - reporterSubstance
    annotations:
      requiresComponent: ''
      required: false

  ClinicalAssayTemplate:
    is_a: AssayDataTemplate
    description: > 
      Template for simple endpoint data from clinical assays often used in diagnostic practice or clinical trials. 
      This can include repeated measures and a drug treatment context.
    slots:
    - parentSpecimenID
    - specimenID
    - experimentalCondition
    - experimentalTimepoint
    - compoundName
    - compoundDose
    - comments
    annotations:
      requiresComponent: ''
      required: false

  GenericMeasuresTemplate:
    is_a: Template
    description: Catch-all template for measures (often in a spreadsheet) for some other phenotype characteristic (in experimentalFactor) over time
    slots:
    - Component
    - Filename
    - resourceType
    - progressReportNumber
    - dataType
    - assay
    - platform
    - individualID
    - parentSpecimenID
    - experimentalFactor
    - experimentalCondition
    - experimentalTimepoint
    - comments
    annotations:
      requiresComponent: ''
      required: false

#######################################
# ClinicalDataTemplate              
#######################################

  ClinicalDataTemplate:
    is_a: Template
    description: A template for submitting more comprehensive participant clinical data.
  
  PatientTemplate:
    is_a: ClinicalDataTemplate
    description: >
      Template for collecting minimal individual-level data. 
    slots:
    - Component
    - individualID
    - sex
    - age
    - ageUnit
    - species
    - diagnosis
    - nf1Genotype
    - nf2Genotype
    annotations:
      requiresComponent: ''
      required: false
  
  PatientTimepointsTemplate:
    is_a: ClinicalDataTemplate
    description: Template for capturing individual-level data with time points. Do not use for data file annotation.
    slots:
    - Component
    - individualID
    - experimentalTimepoint
    annotations:
      requiresComponent: ''
      required: false
  
#######################################
# ResearchToolsTemplate              
#######################################

  ResearchToolsTemplate:
    is_a: Template
    description: A template for describing deposited non-data resources such as source code and protocols.
    slots:
    - title
    - author
    - citation
    - license
    - comments
  
  ProtocolTemplate:
    is_a: ResearchToolsTemplate
    description: Template for describing a protocol document. 
    source: https://bioschemas.org/profiles/LabProtocol/0.7-DRAFT
    slots:
    - protocolAssay
    - protocolPurpose
    - sampleType
    annotations:
      requiresComponent: ''
      required: false
  
  SourceCodeTemplate:
    is_a: ResearchToolsTemplate
    description: Template for describing scripts/other code files for an analysis or software application.
    slots:
    - programmingLanguage
    - documentation
    - runtimePlatform
    annotations:
      requiresComponent: ''
      required: false

#######################################
# Other Artifacts           
#######################################
  
  DatasetTemplate:
    is_a: Template
    description: Template that specifies NF portal dataset properties should have for more consistent community-curated datasets.
    notes:
    - This is intended to be compiled to JSON schema and bound to dataset entities, *not* used in DCA.
    - While "publisher" (repository) may seem redundant, eventually may want to have symbolic datasets like Cancer Complexity Portal that describe datasets hosted somewhere else.
    slots:
    - id # Synapse id used as accession for citation when no doi
    - doi
    - title
    - creator
    - contributor
    - currentVersion
    - description
    - license
    - dataType
    - studyName
    - studyId
    - manifestation
    - diseaseFocus
    - fundingAgency
    - series
    - publisher
    - yearProcessed
    - yearPublished
    - datasetItemCount
    - datasetSizeInBytes
    # - relatedDataset # not yet
    # - supplementalLink # link to interactive multi-qc reports or other materials related to the dataset

  WorkflowReport:
    is_a: Template
    description: Template used for miscellaneous workflow reports and accessory files
    notes:
    - resourceType should default to "workflow report"
    - note that dataType and dataSubtype don't apply
    slots:
    - Component
    - resourceType
    - assay
    - fileFormat
    - relatedDataset
    - workflow
    - workflowLink

#######################################
# PartialTemplate              
#######################################

  UpdateMilestoneReport:
    is_a: PartialTemplate
    description: Metadata template for updating milestone report values in NF studies -- currently a supported feature for NTAP and GFF.
    slots:
    - Filename
    - resourceType
    - progressReportNumber
    annotations:
      requiresComponent: ''
      required: false
