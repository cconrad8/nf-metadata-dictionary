# Top-level editor notes
# - Here [mappings](https://linkml.io/linkml/schemas/uris-and-mappings.html#mappings) indicate closely related templates in other data models

classes:

  Template:
    description: A collection of fields representing some entity. 
    comments: 
    - Also called a manifest depending on context.
    abstract: true


  PartialTemplate:
    description: A template for collecting a subset of contextual data; not intended to be a standalone template but rather a subdocument. 
    abstract: true

############################################################
# Assay Data / Sequencing             
############################################################

  BiologicalAssayDataTemplate:
    is_a: Template
    description: >
      A template for describing deposited data artifacts (i.e. files) from an experimental assay that mainly involves biological organisms.  
      The properties defined here are things that should be collected for all files contributed to NF. 
      Subclasses define additional properties for the type of file (e.g. raw vs processed, imaging vs sequencing).
    slots:
    - Component
    - resourceType # should be constrained to data resource types but we can't do this yet
    - dataType
    - dataSubtype
    - assay # platform added at a later level, see https://github.com/nf-osi/nf-metadata-dictionary/issues/319
    - species
    - individualID # specimenID, aliquotID etc. are added at a later level since they don't make sense for some assay types such as behavioral assays

  NonBiologicalAssayDataTemplate:
    is_a: Template
    description: >
      A template for describing deposited data artifacts (i.e. files) from an experimental assay that main involves non-biological samples.   
    slots:
    - Component
    - resourceType
    - dataType
    - dataSubtype
    - assay
  
  #####################################################
  # Biological Assay Data / Sequencing / Raw            
  #####################################################

  GenomicsAssayTemplate:
    is_a: BiologicalAssayDataTemplate
    description: > 
      Template for raw data on an organism's genome. Genomics assays can provide data limited to specific regions or for the full genome.
      They can be divided into sequencing-based vs. non-sequencing based (e.g. microarrays, optical genome mapping). 
      While nowadays the genomics assay is synonymous with something sequencing-based, this should be kept conceptually open in the current defined properties.
    abstract: true
    notes:
    - This template should only be used to fill in partial data for presumably "novel/other" genomics assays until it can be confirmed which more specific template should be used and which additional data collected. 
    - http://purl.obolibrary.org/obo/GECKO_0000032
    slots:
    - parentSpecimenID
    - specimenID 
    - aliquotID 
    - platform
    - nucleicAcidSource
    annotations:
      requiresComponent: ''
      required: false
  
  SequencingAssayTemplate:
    is_a: GenomicsAssayTemplate
    description: A template for describing raw data from a sequencing assay.
    slots:
    - dissociationMethod
    - runType
    - libraryPrep
    - libraryPreparationMethod
    - libraryStrand
    - readPair
    - readLength
    - readDepth
    - targetDepth
    - batchID

  SequencingAssayTemplateExtended:
    is_a: SequencingAssayTemplate
    description: >
      Genomics assay template but with experiment data for gene perturbation parameters, experimental conditions and time points.
    slots:
    - transplantationType
    - transplantationRecipientSpecies
    - transplantationRecipientTissue
    - experimentalCondition
    - experimentalTimepoint
    - genePerturbed
    - genePerturbationTechnology
    - genePerturbationType
    - comments
    annotations:
      requiresComponent: ''
      required: false
  
  RNASeqTemplate:
    is_a: SequencingAssayTemplate
    description: Template for describing raw data from (bulk) RNA-sequencing
    slots:
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:BulkRNA-seqLevel1

  ScRNASeqTemplate:
    is_a: RNASeqTemplate
    description: Template for describing raw data from single-cell RNA-seq.
    slots:
    - cellID
    - supplementalAsset
    annotations:
      requiresComponent: ''
      required: false

  SpatialTranscriptomicsRNASeqTemplate:
    is_a: RNASeqTemplate
    description: Template for RNA-seq with additional metadata collecction for 10x Visium spatial transcriptomics.
    slots:
    - captureArea
    - slideID
    - slideVersion
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:10xVisiumSpatialTranscriptomics-RNA-seqLevel1
  
  PdxSequencingAssayTemplate:
    is_a: SequencingAssayTemplate
    description: Template for describing describing raw sequencing data from PDX experiment.
    slots:
    - transplantationType
    - transplantationRecipientSpecies
    - transplantationRecipientTissue
    - modelSystemName
    - experimentalCondition
    - experimentalTimepoint
    annotations:
      requiresComponent: ''
      required: false
  
  WGSTemplate:
    is_a: SequencingAssayTemplate
    description: Template for describing raw data from Whole Genome Sequencing (WGS)
    slots:
    annotations:
      requiresComponent: ''
      required: false
  
  WESTemplate:
    is_a: BiologicalAssayDataTemplate
    description: Template for describing raw data from Whole Exome Sequencing (WES)
    slots:
    - targetCaptureKitID
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:BulkWESLevel1

  EpigenomicsSequencingAssayTemplate:
    is_a: SequencingAssayTemplate
    description: Template for describing raw data from epigenetics sequencing assays such as bisulfite sequencing. 
    slots:
    - bisulfiteConversionKitID
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:BulkMethylation-seqLevel1

  MethylationArrayTemplate:
    is_a: GenomicsAssayTemplate
    description: Template for describing raw data from methylation array.
    slots:
    - channel
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:BulkMethylation-seqLevel1
  

  #########################################################
  # Biological Assay Data  / Sequencing / Processed            
  #########################################################
  
  ProcessedAlignedReadsTemplate:
    is_a: BiologicalAssayDataTemplate
    description: >
      Template for describing aligned reads output data (i.e. BAM files).
      The QC meta are extracted from samtools stats when available and are aligned with GDC. 
    slots:
    - genomicReference
    - averageInsertSize
    - averageReadLength
    - averageBaseQuality
    - pairsOnDifferentChr
    - readsDuplicatedPercent
    - readsMappedPercent
    - meanCoverage
    - proportionCoverage10x
    - proportionCoverage30x
    - readDepth
    - totalReads
    - workflow
    - workflowLink
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:
  
  ProcessedVariantCallsTemplate:
    is_a: BiologicalAssayDataTemplate
    description: Template for describing either germline or variant calls output data (i.e. VCF/MAF)
    slots:
    - isFilteredReads
    - workflow
    - workflowLink
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:
  
  ProcessedExpressionTemplate:
    is_a: BiologicalAssayDataTemplate
    description: Template for describing expression output data as counts or counts matrix.
    slots:
    - expressionUnit
    - workflow
    - workflowLink
    annotations:
      requiresComponent: ''
      required: false
  
##################################################
# Biological Assay Data / Proteomics / Raw         
##################################################

  ProteomicsAssayTemplate:
    is_a: BiologicalAssayDataTemplate
    description: > 
      Template for describing raw assay data of an organism's proteome.
    slots:
    - parentSpecimenID
    - specimenID
    - aliquotID
    - platform
    - proteinExtractSource
    annotations:
      requiresComponent: ''
      required: false

  MassSpecAssayTemplate:
    is_a: ProteomicsAssayTemplate
    description: > 
      Template for describing raw mass spec-based assay data.
    slots:
    - dataCollectionMode
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN:MassSpectrometryLevel1
  

##############################################
# Biological Assay Data / Imaging / Raw           
##############################################

  ImagingAssayTemplate:
    is_a: BiologicalAssayDataTemplate
    description: A template for describing data from an imaging assay.
    slots:
    # specimenID not applicable to some imaging; aliquotID not applicable to many imaging
    - platform
    annotations:
      requiresComponent: ''
      required: false
    
  MRIAssayTemplate:
    is_a: ImagingAssayTemplate
    description: Template for describing MRI data.
    slots:
    - MRISequence
    - experimentalCondition
    - experimentalTimepoint
    annotations:
      requiresComponent: ''
      required: false

  MicroscopyAssayTemplate:
    is_a: ImagingAssayTemplate
    description: Template for data from a microscopy assay.
    slots:
    - parentSpecimenID
    - specimenID 
    - aliquotID
    - objective
    - nominalMagnification
    - lensAperture
    - workingDistance
    - workingDistanceUnit
    - immersion
    annotations:
      requiresComponent: ''
      required: false
    close_mappings:
    - HTAN: ImagingLevel2

  IF-IHC-AssayTemplate:
    is_a: MicroscopyAssayTemplate
    description: Template for describing immunofluorescence or immunohistochemistry images. Can be used for CyCIF (highly multiplexed immunofluorescence imaging) data.
    slots:
    - antibodyID
    annotations:
      requiresComponent: ''
      required: false
  

################################################
# Biological Assay Data / Behavioral / Raw            
################################################

  BehavioralAssayTemplate:
    is_a: BiologicalAssayDataTemplate
    description: > 
      Template for describing data from behavioral/cognitive assays such as “adaptive n-back task” (for humans) or “Von Frey test” (for mice). 
      If another modality is used as part of the assay, e.g. fMRI, that data can be linked.
    slots:
    - experimentalCondition
    - experimentalTimepoint
    # linkedData
    - comments
    annotations:
      requiresComponent: ''
      required: false

############################################
# Biological Assay Data / Other / Raw            
############################################
  
  PharmacokineticsAssayTemplate:
    is_a: BiologicalAssayDataTemplate
    description: Template for describing data from a pharmacokinetics assay.
    slots:
    - platform
    - experimentalCondition
    - experimentalTimepoint
    - compoundName
    - compoundDose
    - genePerturbed
    - modelSystemName
    - comments
    annotations:
      requiresComponent: ''
      required: false

  PlateBasedReporterAssayTemplate:
    is_a: BiologicalAssayDataTemplate
    description: Generic template for describing data from a plate-based reporter assay. This is a one-step template.
    slots:
    - assayTarget
    - experimentalCondition
    - experimentalTimepoint
    - reporterGene
    - reporterSubstance
    annotations:
      requiresComponent: ''
      required: false

  FlowCytometryTemplate:
    is_a: BiologicalAssayDataTemplate
    description: Basic template for flow cytometry assay
    slots:
    - platform
    - cellType
    annotations:
      requiresComponent: ''
      required: false

  LightScatteringAssayTemplate:
    is_a: NonBiologicalAssayDataTemplate
    description: Template for dynamic or static light scattering data adapted from ISA-TAB-Nano specs.
    source: https://wiki.nci.nih.gov/display/icr/isa-tab-nano
    slots:
    - platform
    - specimenID
    - materialType
    - pH
    - concentrationMaterial
    - concentrationMaterialUnit
    - concentrationNaCl
    - concentrationNaClUnit
    annotations:
      requiresComponent: ''
      required: false

  OtherMeasureAssayTemplate:
    is_a: BiologicalAssayDataTemplate
    description: > 
      Catch-all template for quantified measures often multi-individual level data in a spreadsheet. 
      Can be simple endpoint data from clinical trials. This can include repeated measures and a drug treatment context.
    slots:
    - experimentalFactor
    - experimentalCondition
    - experimentalTimepoint
    - compoundName
    - compoundDose
    - comments
    annotations:
      requiresComponent: ''
      required: false

#######################################
# Patient Clinical Data         
#######################################
  
  PatientTemplate:
    is_a: Template
    description: >
      Template for collecting *minimal* individual-level data. 
    slots:
    - individualID
    - sex
    - age
    - ageUnit
    - species # should be constrained to human
    - diagnosis
    - nf1Genotype
    - nf2Genotype
    annotations:
      requiresComponent: ''
      required: false

  PatientXTemplate:
    is_a: PatientTemplate
    description: (WIP / not yet used) Extended template for participant clinical data as recommended per Sundby et al.
    slots:
    annotations:
      requiresComponent: ''
      required: false

  PatientSpecimenTemplate:
    is_a: PatientTemplate
    description: Template for capturing specimen-level data from patients.
    slots:
    - parentSpecimenID
    - specimenID
    - aliquotID
    - tumorType
    - bodySite
    annotations:
      requiresComponent: ''
      required: false
  
#######################################
# Research Tools      
#######################################

  ProtocolTemplate:
    is_a: Template
    description: Template for describing a protocol document. 
    source: https://bioschemas.org/profiles/LabProtocol/0.7-DRAFT
    slots:
    - title
    - author
    - citation
    - license
    - protocolAssay
    - protocolPurpose
    - sampleType
    - comments
    annotations:
      requiresComponent: ''
      required: false
  
  SourceCodeTemplate:
    is_a: Template
    description: Template for describing scripts/other code files for an analysis or software application.
    slots:
    - title
    - author
    - citation
    - license
    - programmingLanguage
    - runtimePlatform
    - documentation
    annotations:
      requiresComponent: ''
      required: false

#######################################
# Other Artifacts           
#######################################
  
  DatasetTemplate:
    is_a: Template
    description: Template that specifies NF portal dataset properties should have for more consistent community-curated datasets.
    notes:
    - This is intended to be compiled to JSON schema and bound to dataset entities, *not* used in DCA.
    - While "publisher" (repository) may seem redundant, eventually may want to have symbolic datasets like Cancer Complexity Portal that describe datasets hosted somewhere else.
    slots:
    - id # Synapse id used as accession for citation when no doi
    - doi
    - title
    - creator
    - contributor
    - currentVersion
    - description
    - license
    - dataType
    - studyName
    - studyId
    - manifestation
    - diseaseFocus
    - fundingAgency
    - series
    - publisher
    - yearProcessed
    - yearPublished
    - datasetItemCount
    - datasetSizeInBytes
    # - relatedDataset # not yet
    # - supplementalAsset # link to interactive multi-qc reports or other materials related to the dataset

  WorkflowReport:
    is_a: Template
    description: Template used for miscellaneous workflow reports and accessory files
    notes:
    - resourceType should default to "workflow report"
    - note that `dataType` and `dataSubtype` don't apply
    slots:
    - resourceType
    - assay
    - fileFormat
    - relatedDataset
    - workflow
    - workflowLink

#######################################
# PartialTemplate              
#######################################

  UpdateMilestoneReport:
    is_a: PartialTemplate
    description: Metadata template for updating milestone report values in NF studies -- currently a supported feature for NTAP and GFF.
    slots:
    - Filename
    - resourceType
    - progressReportNumber
    annotations:
      requiresComponent: ''
      required: false
